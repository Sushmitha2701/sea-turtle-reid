# ResNet-50 Configuration for Sea Turtle Re-Identification
# Optimal for maximum accuracy applications

model:
  architecture: "resnet50"
  num_classes: 438  # Number of unique individuals in SeaTurtleID2022
  pretrained: true
  feature_dim: 512
  dropout: 0.5

dataset:
  name: "SeaTurtleID2022"
  root: "data/SeaTurtleID2022"
  image_size: [256, 128]  # [height, width]
  temporal_split:
    ratios: [0.7, 0.15, 0.15]  # train, query, gallery
    ensure_zero_leakage: true

training:
  epochs: 25
  batch_size: 32
  num_workers: 4
  
  optimizer:
    type: "Adam"
    lr: 0.00035
    betas: [0.9, 0.999]
    weight_decay: 0.0005
  
  scheduler:
    type: "StepLR"
    step_size: 10
    gamma: 0.1
  
  loss:
    # Multi-objective loss: CrossEntropy + Triplet + Center
    cross_entropy_weight: 1.0
    triplet_weight: 0.5
    center_weight: 0.0005
    triplet_margin: 0.3
    
  # Class imbalance handling
  class_weights: true
  balanced_sampling: false

augmentation:
  train:
    - RandomHorizontalFlip: {p: 0.5}
    - RandomCrop: {size: [256, 128], padding: 10}
    - ColorJitter: {brightness: 0.1, contrast: 0.1, saturation: 0.1}
    - ToTensor: {}
    - Normalize: {mean: [0.485, 0.456, 0.406], std: [0.229, 0.224, 0.225]}
  
  test:
    - Resize: {size: [256, 128]}
    - ToTensor: {}
    - Normalize: {mean: [0.485, 0.456, 0.406], std: [0.229, 0.224, 0.225]}

evaluation:
  distance_metric: "euclidean"
  max_rank: 50
  rerank: false

logging:
  tensorboard: true
  wandb: false
  print_freq: 10
  eval_freq: 1  # Evaluate every N epochs
  save_freq: 5  # Save checkpoint every N epochs

checkpoint:
  save_best: true
  save_last: true
  metric: "rank-1"  # Metric to determine "best" model

# Expected Performance (from dissertation)
# Rank-1: 2.45%
# Rank-5: 7.64%
# Rank-10: 13.83%
# Rank-20: 19.88%
# mAP: 0.0276
# Training time: ~47 minutes on Tesla T4
